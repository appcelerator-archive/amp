version: "2"

services:
  sut:
    image: appcelerator/sut
    build: .
    command: ["make", "test"]
    environment:
      ES_URL: http://elasticsearch:9200
  elasticsearch:
    image: appcelerator/elasticsearch-amp:latest
  etcd:
    image: quay.io/coreos/etcd
    command: [
      "etcd",
      "-name", "etcd0",
      "-advertise-client-urls", "http://etcd:2379,http://etcd:4001",
      "-listen-client-urls", "http://0.0.0.0:2379,http://0.0.0.0:4001",
      "-initial-advertise-peer-urls", "http://etcd:2380",
      "-initial-cluster-token", "etcd-cluster-1",
      "-initial-cluster", "etcd0=http://etcd:2380",
      "-initial-cluster-state", "new"
    ]